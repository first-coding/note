- VAE等生成模型存在生成质量差，图像模糊
- 用对抗：生成器生图，判别器判别是生成器生成还是真实数据。
- 对抗模型存在一下几个问题：
	- **训练不稳定：G和D训练过程容易不平衡，一个强另一个就无法学习**
	- **梯度消失**
	- **模式奔溃：G只会生成一种风格，即没学到真正的数据概率分布**
- **训练流程**：
	- 分别从噪声Z和真实数据集中得到图像
	- 判别器判别真假，计算损失
	- 更新判别器参数
	- 再次采样Z，得到G(z)
	- 用D(G(z))计算生成器损失
	- 更新生成器参数
- 损失函数：
	- **原始的损失函数**：详细见[[LOSS#^cb7f0c|对抗损失]]
		- ![[Pasted image 20250510152751.png]]
		- D(x)判别器对真实样本x给出概率，目标是D(x)->1
		- D(G(z))判别器对生成样本给出概率，目标是->0
		- 拆分得到：
			- 判别器损失函数：![[Pasted image 20250510152957.png]]
			- 最大化这个和，D(x)->1,D(G(z))->0
			- 生成器损失函数：![[Pasted image 20250510153013.png]]
			- 使得D(G(z))->1
			- 在训练过程中，生成器和判别器交替更新
			- 但这个原始损失函数存在训练不稳定，梯度消失，模式奔溃问题，引入新的损失函数
	- **WGAN**：见[[LOSS#^63e6b7|WGAN]]
- 模型：
	- origin GAN：全连接层构建生成器和判别器
	- DCGAN：卷积层替代全连接层，生成器用反卷积上采样
	- Pix2Pix：有配对图像，用U-Net生成+PatchGAN判别
	- CycleGAN：双生成器+双判别器+循环一致性损失
	- StyleGAN：引入latent ω，逐个生成，[原文](https://arxiv.org/pdf/1812.04948)
		- 原始GAN从噪声z生成图像，无法控制细节部分
		- ![[Pasted image 20250510154844.png]]
		- 详见![[Pasted image 20250510154727.png]]